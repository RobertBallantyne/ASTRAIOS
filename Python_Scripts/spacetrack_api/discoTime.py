from pprint import pprint
import requests
import pandas as pd
import time


def disco(catIDs):
    URL = 'https://discosweb.esoc.esa.int'
    token = 'IjgzN2YyYjYxLTljOGItNGZlOC1iMDBjLTNmN2Y3YjBhOTBmOCI.zs5D_xzvnomvzdjW2vHLAWtd0QE'

    satInfo = pd.DataFrame()
    satCount = 0
    for i in catIDs:

        i = i.lstrip("0")
        filter = "eq(satno," + i + ")"
        response = requests.get(
            f'{URL}/api/objects',
            headers={'Authorization': f'Bearer {token}'},
            params={
                'filter': filter,
            },
        )
        ret = response.json()
        retData = ret['data']
        retAtt = retData[0]['attributes']
        satInfo = satInfo.append(retAtt, ignore_index=True)
        if satCount > 19:
            time.sleep(60)
            satCount = 0
        else:
            satCount +=1 


    csvFile = 'info.csv'
    satInfo.to_csv(csvFile, index=False)
    # file = open(outName, 'w')
    # file.write(retData)
    # file.close()
    return csvFile


disco(['00614','00746','00750','00829','00831','00963','01613','01616','01863','02150','02389','02643','02800','02971','04221','04251','04298','04354','04377','04903','05729','05730','05975','05977','06073','07003','07337','07688','07800','08018','08134','08744','09330','09648','09880','10594','10723','11028','11057','11745','11765','11984','12138','12139','12295','12354','12388','12445','12497','12546','12787','12848','12849','13007','13011','13016','13075','13608','13609','13658','13666','13844','13845','13874','13912','13971','14051','14135','14136','14143','14144','14180','14277','14278','14483','14524','14607','14608','14728','14729','14756','14795','14900','15053','15054','15206','15244','15245','15246','15265','15266','15354','15387','15388','15390','15402','15544','15562','15644','15680','15714','15715','15832','15836','15837','15874','15952','16001','16007','16229','16293','16294','16295','16483','16624','16625','16630','16631','16993','16996','17253','17255','17325','17563','18008','18009','18010','18025','18571','18598','18904','18953','19219','19537','19549','19595','19622','19822','19884','19920','19970','20081','20082','20170','20229','20303','20316','20356','20404','20411','20453','20469','20474','20559','20630','20669','20712','20713','20717','20718','20774','20775','20811','20843','20947','20965','21151','21226','21393','21588','21589','21590','21634','21635','21637','21640','21727','21778','21815','21818','21826','21827','21905','21942','21948','21970','22032','22101','22196','22315','22594','22655','22670','22725','22797','22818','22849','22913','22979','22980','22996','23038','23040','23041','23125','23177','23191','23198','23201','23229','23278','23279','23468','23523','23538','23590','23614','23647','23671','23697','23725','23732','23756','23766','23847','23866','23867','23950','23966','23968','24285','24286','24654','24721','24724','24739','24892','24937','25054','25279','25282','25330','25461','25502','25539','25540','25542','25586','25588','25619','25667','25671','25672','25675','25767','25808','25809','25837','25844','25868','25904','25936','25968','26037','26048','26053','26072','26076','26096','26106','26299','26358','26374','26375','26383','26389','26488','26490','26591','26636','26678','26696','26728','26782','26791','26803','26809','26851','26882','26898','26899','26901','26967','27031','27049','27051','27367','27368','27390','27402','27405','27446','27489','27500','27530','27604','27650','27661','27662','27671','27684','27692','27731','27740','27805','27821','27876','27923','28116','28118','28144','28145','28155','28160','28188','28193','28243','28359','28382','28385','28395','28528','28544','28545','28632','28645','28661','28870','28876','28900','28926','28938','28939','28947','28948','28980','28981','28982','28983','29093','29164','29165','29271','29274','29275','29317','29325','29414','29422','29445','29446','29498','29517','29519','29530','29531','29532','29533','29534','29646','29649','29657','29668','29669','29710','30324','30611','30795','31037','31103','31136','31289','31299','31308','31335','31450','31500','31636','31842','31983','32021','32030','32037','32040','32203','32254','32290','32295','32370','32374','32379','32398','32399','32406','32407','32499','32501','32730','32766','32769','33057','33058','33155','33156','33276','33279','33374','33406','33437','33450','33454','33461','33462','33472','33473','33544','33597','33617','33752','33754','34030','34184','34186','34193','34194','34236','34248','34712','34780','35008','35114','35428','35467','35495','35544','35545','35549','35552','35557','35754','35757','35875','35944','36034','36103','36115','36116','36133','36288','36407','36461','36501','36583','36594','36746','36747','36794','36832','36833','36869','36959','36963','36983','37143','37159','37187','37198','37206','37208','37220','37235','37253','37260','37266','37287','37347','37363','37378','37394','37500','37604','37607','37747','37762','37777','37778','37811','37828','37845','37871','37884','37896','38050','38089','38095','38100','38246','38269','38318','38333','38334','38344','38353','38549','38553','38554','38558','38576','38583','38585','38597','38601','38608','38654','38674','38677','38742','38744','38745','38746','38748','38750','38752','38753','38780','38781','38884','38888','38921','38922','38926','38948','38954','38957','38959','38960','38961','38971','38993','39010','39036','39037','39069','39080','39081','39124','39129','39158','39165','39174','39200','39217','39218','39235','39236','39265','39266','39267','39268','39269','39270','39271','39287','39341','39344','39345','39347','39348','39362','39369','39371','39477','39510','39511','39524','39600','39618','39619','39636','39774','39800','39801','39915','40108','40148','40149','40159','40171','40181','40184','40195','40268','40270','40273','40274','40306','40334','40354','40366','40368','40377','40378','40386','40426','40507','40548','40615','40618','40659','40660','40665','40666','40698','40734','40735','40750','40788','40813','40845','40876','40877','40884','40913','40942','40986','41022','41030','41031','41108','41172','41193','41242','41309','41312','41333','41336','41381','41383','41385','41470','41583','41587','41593','41594','41635','41641','41642','41677','41683','41686','41688','41692','41749','41750','41768','41795','41811','41837','41839','41870','41896','41897','41905','41943','41946','41947','42071','42433','42467','42469','42470','42663','42693','42694','42739','42742','42743','42751','42764','42798','42816','42817','42819','42855','42857','42858','42864','42868','42876','42878','42882','42883','42885','42888','42891','42892','42918','42922','42927','42936','42944','42952','42953','42966','42968','42970','42979','43004','43025','43037','43089','43097','43110','43150','43173','43176','43177','43179','43198','43209','43229','43247','43273','43274','43287','43305','43363','43371','43373','43377','43379','43382','43384','43438','43451','43464','43492','43507','43527','43528','43563','43606','43607','43612','43624','43634','43635','43637','43649','43739','43825','43826','43869','43875','44036','44037','44050','44068','44077','44134','44205','44232','44301','44309','44321','44335','44336','44347','44348','44352','44354','44355','44356','44357','44360','44361','44362','44370','44375','44381','44383','44386','44434','44435','44459','44477','44478','44480','44482','44493','44494','44521','44525','44540','44559','44560','44594','44615','44627','44635','44638','44710','44787','44796','44797','44802','44803','44820','44867','44869','44870','44872','44901','44979','44982','45023','45028','45029','45035','45036','45040','45243','45247','45248','45345','45349','45463','45489','45490','45491','45492','45493','45494','45496','45497','45498','45499','45529','45530','45595','45615','45617','45618','45621','45622','45626','45627','45630','45636','45637','45638','45641','45642','45645','45647','45648','45651','45808','45818','45829','45834','45842','45845','45847','45858','45864','45878','45892','45893','45902','45906','45909','45910','45921','45923','45926','45927','45929','45933','45934','45937','45942','45957','45962','45971','45982','45988','46001','46005','46006','46009','46017','46115','46116','46347','46349','46359','46361','46363','46365','46366','46376','46391','46396','46398','46402','46407','46613','46620','46626','46917','46920','47109','47121','47194','47203','47232','47241','47243','47257','47301','47307','47316','47321','47322','47331','47334','47348','81014','81111','81182','81634','81795','81821','81872','81905','82110','82314','82778','83970','84026','84071','84136','84170','84197','84232','84249','84292','84342','84346','84414','84415','84452','84479','84480','84481','84588','85001','87053','87455','87521','87784','87818','87997','88079','88238','88255','88270','88288','88313','88342','89067','89285','89314','89341'])
